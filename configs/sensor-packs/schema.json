{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Sensor Pack Definition",
  "type": "object",
  "required": [
    "id",
    "name",
    "class",
    "description",
    "sensors",
    "calibration",
    "fusion",
    "telemetry",
    "validation"
  ],
  "properties": {
    "id": {
      "type": "string",
      "pattern": "^[a-z0-9-]+$",
      "description": "Sensor pack identifier"
    },
    "name": { "type": "string" },
    "class": {
      "type": "string",
      "enum": ["Rugged", "Urban", "Highway", "Defense", "Custom" ]
    },
    "description": { "type": "string" },
    "vehicle_classes": {
      "type": "array",
      "items": { "type": "string" }
    },
    "sensors": {
      "type": "object",
      "required": ["lidar", "camera", "radar", "imu", "gps"],
      "properties": {
        "lidar": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["model", "fov", "range_m", "refresh_rate_hz", "mount"],
            "properties": {
              "model": { "type": "string" },
              "count": { "type": "integer", "minimum": 1 },
              "fov": { "type": "number" },
              "range_m": { "type": "number" },
              "refresh_rate_hz": { "type": "number" },
              "mount": { "type": "string" },
              "ingress_protection": { "type": "string" }
            }
          }
        },
        "camera": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["model", "resolution", "fov", "refresh_rate_hz"],
            "properties": {
              "model": { "type": "string" },
              "count": { "type": "integer", "minimum": 1 },
              "resolution": { "type": "string" },
              "fov": { "type": "number" },
              "refresh_rate_hz": { "type": "number" },
              "night_vision": { "type": "boolean" }
            }
          }
        },
        "radar": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["model", "range_m", "refresh_rate_hz"],
            "properties": {
              "model": { "type": "string" },
              "count": { "type": "integer", "minimum": 1 },
              "range_m": { "type": "number" },
              "refresh_rate_hz": { "type": "number" }
            }
          }
        },
        "imu": {
          "type": "object",
          "required": ["model", "drift_deg_per_hr"],
          "properties": {
            "model": { "type": "string" },
            "drift_deg_per_hr": { "type": "number" }
          }
        },
        "gps": {
          "type": "object",
          "required": ["model", "frequency_hz", "rtk"],
          "properties": {
            "model": { "type": "string" },
            "frequency_hz": { "type": "number" },
            "rtk": { "type": "boolean" }
          }
        },
        "supplemental": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["type", "model"],
            "properties": {
              "type": { "type": "string" },
              "model": { "type": "string" },
              "count": { "type": "integer" },
              "notes": { "type": "string" }
            }
          }
        }
      }
    },
    "calibration": {
      "type": "object",
      "required": ["schedules", "procedures"],
      "properties": {
        "schedules": {
          "type": "array",
          "items": { "type": "string" }
        },
        "procedures": {
          "type": "array",
          "items": { "type": "string" }
        },
        "tools": {
          "type": "array",
          "items": { "type": "string" }
        }
      }
    },
    "fusion": {
      "type": "object",
      "required": ["latency_budget_ms", "algorithms", "confidence_thresholds"],
      "properties": {
        "latency_budget_ms": { "type": "number" },
        "algorithms": {
          "type": "array",
          "items": { "type": "string" }
        },
        "confidence_thresholds": {
          "type": "object",
          "additionalProperties": { "type": "number" }
        }
      }
    },
    "telemetry": {
      "type": "object",
      "required": ["sampling_hz", "data_contract"],
      "properties": {
        "sampling_hz": { "type": "number" },
        "compression": { "type": "string" },
        "data_contract": { "type": "string" }
      }
    },
    "validation": {
      "type": "object",
      "required": ["hil_tests", "track_tests", "field_tests"],
      "properties": {
        "hil_tests": { "type": "array", "items": { "type": "string" } },
        "track_tests": { "type": "array", "items": { "type": "string" } },
        "field_tests": { "type": "array", "items": { "type": "string" } }
      }
    }
  }
}
