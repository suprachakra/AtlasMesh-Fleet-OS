# risk/catalog.yaml
# Canonical, machine-readable risk register (enforced by lint/risk-rules.yml)
version: 1
risks:
  - id: R-001
    title: Remote Fleet Disabling (mass unauthorized commands)
    category: cybersecurity
    severity: high
    likelihood: medium
    blocking: true
    description: >
      Attacker abuses control plane or misuses admin to disable/“mark stolen” vehicles en masse.
    kris:
      - id: MET.SEC.DETECT_TTA
        target: "≤300s"
        tripwire_red: ">300s over 5m window"
      - id: MET.SEC.ATTEST_FAIL_RATE
        target: "≤0.5%/15m"
        tripwire_red: ">0.5% for 15m"
    controls:
      preventive: ["mTLS everywhere", "HSM-backed keys", "ABAC + JIT access", "Signed control intents"]
      detective: ["SIEM correlation rules", "UEBA on admin actions", "Anomaly alerts on fleet state"]
      corrective: ["SOAR auto-isolate tenant/vehicle", "Key rotation", "Forensic snapshot"]
    fallback: "Graduated safe-stop; unaffected tenants continue; staged un-isolation after attestation passes."
    evidence_sot: ["siem/alerts/*", "ota/attestation/logs/*", "security/sbom/*.spdx.json"]
    owners: ["CISO", "SRE Lead"]
    lifecycle: ["pilot", "prod1", "scale"]
    sectors: ["def", "min", "log", "rh"]
    scenarios: ["SCN.DEF.D1_CONVOY_RESUPPLY", "SCN.LOG.L1_YARD_SWITCHER", "SCN.RH.R1_STD"]
    requirements: ["NFR-SEC-001", "NFR-SEC-OTA-001"]

  - id: R-002
    title: Supply Chain Compromise (malicious dependency/firmware)
    category: cybersecurity
    severity: high
    likelihood: medium
    blocking: true
    kris:
      - id: MET.SEC.CVE_AGE
        target: "≤15d critical"
        tripwire_red: ">15d"
      - id: MET.SEC.SIGNED_ARTIFACT_RATE
        target: "100%"
        tripwire_red: "<100%"
    controls:
      preventive: ["SBOM (SPDX)", "Sigstore signing/verify", "Vendor attestation", "Pinned versions"]
      detective: ["SCA scans per build", "Runtime attestation"]
      corrective: ["Hotfix within 72h", "Forced OTA update", "Vendor quarantine"]
    fallback: "Freeze affected component set; roll back to last green."
    evidence_sot: ["ci/sca/reports/*", "release/sboms/*", "attesters/*"]
    owners: ["SVP Eng", "CISO"]
    lifecycle: ["prod1", "scale"]
    sectors: ["def", "min", "log", "rh"]

  - id: R-003
    title: Cloud DDoS / Latency Spike
    category: cybersecurity
    severity: medium
    likelihood: medium
    blocking: false
    kris:
      - id: MET.NET.RTT_P95
        target: "≤500ms"
        tripwire_red: ">500ms for 10m"
    controls:
      preventive: ["WAF/rate limiting", "Autoscale control plane"]
      detective: ["RTT/5xx monitors", "Upstream provider alerts"]
      corrective: ["Traffic scrubbing", "Regional failover"]
    fallback: "Offline-first mode up to 60 minutes; queue non-critical uploads."
    evidence_sot: ["sre/dashboards/net/*", "incidents/*.md"]
    owners: ["SRE Lead"]
    lifecycle: ["pilot", "prod1", "scale"]
    sectors: ["def", "min", "log", "rh"]

  - id: R-010
    title: Sensor Degradation (heat/dust/precipitation)
    category: technical
    severity: high
    likelihood: high
    blocking: true
    kris:
      - id: MET.PERCEP.CONF_P50
        target: "≥0.70"
        tripwire_red: "<0.70 for 60s"
      - id: MET.SAFETY.VISIBILITY_BAND
        target: "≥Vmin sector"
        tripwire_red: "<Vmin for 60s"
    controls:
      preventive: ["Dust-aware fusion", "Sensor cleaning cadence", "Thermal design & derate curves"]
      detective: ["Occlusion rate monitor", "Thermal throttle alerts"]
      corrective: ["Route avoidance", "Dynamic speed caps"]
    fallback: "Degrade mode; pull to pre-validated safe-stop bay if confidence remains low."
    evidence_sot: ["telemetry/perception/*", "weather/provenance/*"]
    owners: ["Perception Lead", "Platform HW Lead"]
    lifecycle: ["pilot", "prod1", "scale"]
    sectors: ["def", "min", "log", "rh"]
    scenarios: ["SCN.MIN.M16_DUST_SUPPRESS", "SCN.DEF.D26_RUGGED_TERRAIN"]

  - id: R-011
    title: GNSS Denial/Jamming
    category: technical
    severity: high
    likelihood: medium
    blocking: true
    kris:
      - id: MET.RELIAB.ODD_CONFORMANCE
        target: "≥98%"
        tripwire_red: "<98% in GNSS-low tiles"
    controls:
      preventive: ["SLAM fallback", "Convoy leader-follower", "RF map & spoof detection"]
      detective: ["GNSS integrity monitor"]
      corrective: ["Reroute to slam-friendly corridors", "Mission replanning"]
    fallback: "ODD clamp; safe convoy mode only."
    evidence_sot: ["odd/guard/logs/*", "slam/confidence/*"]
    owners: ["Routing Lead"]
    lifecycle: ["pilot", "prod1", "scale"]
    sectors: ["def"]

  - id: R-012
    title: Connectivity Loss (LTE/5G/private)
    category: technical
    severity: medium
    likelihood: high
    blocking: false
    kris:
      - id: MET.NET.UPLINK_LOSS_MINS
        target: "≤10m"
        tripwire_red: ">10m"
    controls:
      preventive: ["Store-and-forward", "Mesh relays", "SAT backup"]
      detective: ["Loss/latency sentry"]
      corrective: ["Batching, resend policies"]
    fallback: "Local autonomy ≤60m; defer non-critical sync."
    evidence_sot: ["net/health/*"]
    owners: ["Edge Lead"]
    lifecycle: ["pilot", "prod1", "scale"]
    sectors: ["def", "min", "log"]

  - id: R-020
    title: Dispatcher Overload
    category: operational
    severity: medium
    likelihood: medium
    blocking: false
    kris:
      - id: MET.UX.TRIAGE_TTD_P95
        target: "≤60s"
        tripwire_red: ">60s 10m"
      - id: MET.SAFETY.ASSIST_QUEUE_DEPTH
        target: "≤N"
        tripwire_red: ">N 10m"
    controls:
      preventive: ["Scripted macros", "Case clustering", "Autoscale assist pods"]
      detective: ["Queue depth monitors"]
      corrective: ["Intake clamp", "Reroute to low-risk queues"]
    fallback: "Temporary ODD clamp; pre-approved deferrals."
    evidence_sot: ["assist/ops/*"]
    owners: ["Ops Lead"]
    lifecycle: ["pilot", "prod1", "scale"]
    sectors: ["def", "log", "rh"]

  - id: R-021
    title: Assist Overuse (policy coverage gaps)
    category: operational
    severity: medium
    likelihood: medium
    blocking: true
    kris:
      - id: MET.SAFETY.ASSIST_RATE
        target: "≤0.3/1k km"
        tripwire_red: ">0.5/1k km (24h)"
    controls:
      preventive: ["Policy expansion", "Scenario mining", "Operator coaching"]
      detective: ["Assist taxonomy analytics"]
      corrective: ["Build rollback", "Targeted sim coverage"]
    fallback: "Raise assist budget under waiver with CRO sign-off; publish mitigation ETA."
    evidence_sot: ["assist/weekly-rca/*", "sim/scenario-coverage/*"]
    owners: ["Safety Lead", "PM Lead"]
    lifecycle: ["pilot", "prod1"]
    sectors: ["all"]

  - id: R-030
    title: Mixed-Traffic Collision Risk
    category: safety
    severity: high
    likelihood: medium
    blocking: true
    kris:
      - id: MET.SAFETY.INCIDENT_RATE
        target: "0 critical"
        tripwire_red: "any critical"
      - id: MET.EXP.WORKZONE_ASSIST_DELTA
        target: "-40% q/q"
        tripwire_red: "no improvement 2q"
    controls:
      preventive: ["Work-zone policies", "LE interaction protocols", "Explainable warnings"]
      detective: ["Near-miss miner", "Vision confidence sentry"]
      corrective: ["Route avoidance", "Feature rollback"]
    fallback: "Suspend mixed-traffic tiles; operate only in permitted corridors."
    evidence_sot: ["safety/incidents/*", "odd/workzones/*"]
    owners: ["Head of Safety"]
    lifecycle: ["prod1", "scale"]
    sectors: ["rh", "log"]

  - id: R-040
    title: Model Drift (data shift)
    category: ml
    severity: medium
    likelihood: medium
    blocking: true
    kris:
      - id: MET.ML.DRIFT_SCORE
        target: "≤θ"
        tripwire_red: ">θ 30m"
      - id: MET.ML.OOD_RATE
        target: "≤x%"
        tripwire_red: ">x% 30m"
    controls:
      preventive: ["Data QA pipeline", "Shadow eval", "Canary rollout"]
      detective: ["Drift sentry", "Error monitors"]
      corrective: ["Rollback", "Retrain job"]
    fallback: "Revert to last green; temporary assist budget uplift."
    evidence_sot: ["ml/drift/*", "ml/model-cards/*"]
    owners: ["Head of Data"]
    lifecycle: ["prod1", "scale"]
    sectors: ["all"]

  - id: R-050
    title: Adapter/API Drift (WMS/TOS/ERP)
    category: integration
    severity: medium
    likelihood: high
    blocking: true
    kris:
      - id: MET.INT.CONTRACT_TEST_PASS%
        target: "100%"
        tripwire_red: "<100%"
    controls:
      preventive: ["Contract tests", "Version pinning", "Adapter canary"]
      detective: ["Error-rate alarms", "Schema diff"]
      corrective: ["Fallback CSV/API shim", "Hotfix within 24h"]
    fallback: "Manual handoff protocol; reduced automation mode."
    evidence_sot: ["integrations/contract-tests/*", "observability/error-rates/*"]
    owners: ["Integrations Lead"]
    lifecycle: ["pilot", "prod1", "scale"]
    sectors: ["log", "def"]

  - id: R-060
    title: Downtime Cost Exposure
    category: business
    severity: medium
    likelihood: medium
    blocking: false
    kris:
      - id: MET.COST.$_PER_DOWNTIME_HR
        target: "≤ site SLA"
        tripwire_red: "> SLA"
      - id: MET.RELIAB.AVAIL_ODD
        target: "≥99.3%"
        tripwire_red: "<98.5%"
    controls:
      preventive: ["Predictive maintenance", "Spares SLA", "Hot-swap kits"]
      detective: ["Uptime SLOs", "PdM health"]
      corrective: ["Rapid RMA", "Credit policy"]
    fallback: "Customer comms + credits; reprioritize fleet."
    evidence_sot: ["ops/uptime/*", "finance/impact-models/*"]
    owners: ["COO"]
    lifecycle: ["prod1", "scale"]
    sectors: ["all"]
