
# AtlasMesh Fleet OS — Agnostics Decision Matrix (v1.0)

> **Variant Budget (repo-wide):** ≤ **5% core code delta** and ≤ **25% test-time delta** per release caused by any one tenet. Exceed → **CCB** review → de-scope or carve-out.

**Legend:**
**OKRs:** O-1 Safety · O-2 Time-to-Value · O-3 Cost & Scale · O-4 Regulatory · O-5 UX
**Epics (examples):** E-01 Vehicle Abstraction · E-02 Policy Engine · E-03 Twin-Gated CI/CD · E-04 Evidence · E-05 Dispatch/Routing · E-06 Energy · E-07 PdM · E-08 Map Fusion · E-09 Tele-Assist · E-10 Weather Fusion · E-11 Offline-First · E-12 Multi-Sensor · E-13 Control Center · E-14 Deployment Automation · E-15 Enterprise Integration
**Bodies:** **CCB** (Change Control Board), **SAB** (Safety Advisory Board), **DAB** (Design/Architecture Board), **CAB** (Compliance Advisory Board)

---

### One Matrix to Govern All Agnostics

| Tenet (ID)                              | Decision                                             | Scope v1 (In / Out)                                                                                                                                                                                                     | Guardrails (hard rules)                                                                                                                                    | KPIs / SLOs                                                                                                                                                                                            | Evidence / Validation                                                                                                          | Risks → Mitigations                                                                                                                         | Change Control (Body)                                                                       | Kill-Switch                                                                                                               | Expansion Criteria                                                                            | OKR → Epics                  | Gates & Repo Paths                                                                                                                                                      |
| --------------------------------------- | ---------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------- | ---------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Vehicle-Agnostic (V-AG)**             | **Qualified YES** (class-level, model-bounded)       | **In:** Light/Med/Heavy, Defense UGV; certified DBW, redundant braking. **Out:** Rail/air/marine; non-deterministic actuators; no-DBW; one-off prototypes lacking safety artifacts.                                     | Per-model **Vehicle Profile**; controller/planner params are config-only; **Safety Bundle** (HARA/FMEA deltas, stop certs, HiL traces); **no core forks**. | Availability ≥ **99.0%** across ≥3 classes; assist ≤ **2/1,000 km**; stop distance ±**5%** spec; telemetry gap < **0.5%/24h**.                                                                         | HiL per profile; closed-course brake/stability; PR sim gates w/ dynamics surrogates; on-road shadow; artifacts on release tag. | Dynamics mismatch → profile conformance tests. DBW faults → watchdog + degraded modes. Supply variance → profile templates + adapter tests. | New model/profile → **CCB+SAB** with Safety Bundle; deprecations ≥ **2 releases** notice.   | ≥ **2** profile-gap criticals/2 qtrs or > **25%** schedule slip due to variance → pause new profiles; revert Tier-A only. | 2 releases meet KPIs + **TCO ↓ ≥15%** vs single-vehicle baseline → add one model/class.       | O-1/O-2/O-3 → E-01/E-03/E-11 | **G-V-01** Twin gate pass; **G-V-02** Profile conformance CI. Paths: `/configs/vehicles/*`, `/edge/vehicle-agent/*`, `/sim/scenario-bank/vehicle/*`                     |
| **Platform-Agnostic (P-AG)**            | **YES** (K8s-first, provider-neutral)                | **In:** EKS/GKE/AKS/k3s, CSI/CNI, Postgres, Kafka/NATS, S3-compatible, OTel, Vault/KMS adapters. **Out:** Proprietary PaaS lock-ins; serverless coupling; cloud-specific IAM in app code.                               | Single deploy interface (Helm/Kustomize/Terraform); infra conformance tests; SBOM signing; no provider conditionals in app logic.                          | Green CI on cloud+on-prem; cold start ≤ **60m**; P99 RPC budget held across providers.                                                                                                                 | Multi-provider CI jobs; load SLO attestations; IaC drift logs.                                                                 | Feature gaps → adapter + graceful degrade. Cost creep → FinOps dashboards. Ops sprawl → runbooks per provider.                              | New provider → **DAB+CCB** after conformance pass; 2-release deprecation window.            | Provider causes SLO breach or **TCO +>25%** → downgrade to Tier-B.                                                        | 2 clients live with SLOs met → Tier-A.                                                        | O-2/O-3 → E-14/E-15          | **G-P-01** Conformance suite; **G-P-02** SBOM/Provenance. Paths: `/deploy/terraform`, `/deploy/helm`, `/security/sbom`, `/ci/pipelines`                                 |
| **Sector-Agnostic (S-AG)**              | **YES** (shared backbone + overlays)                 | **In:** Defense, Mining, Logistics/Ports, Ride-hail via policies/KPIs/UI tokens. **Out:** Rail, crewed aviation, maritime autonomy (later).                                                                             | **Policy engine** gates; jurisdiction packs; design tokens; evidence mappers; sector workspace modes.                                                      | ≥ **90%** code shared; sector UI ≤ **5%**; SLAs met in **≥2** sectors per release.                                                                                                                     | Sector acceptance scenarios; policy unit tests; evidence mapped to sector frameworks.                                          | UX confusion → sector modes. Compliance drift → policy versioning + audits.                                                                 | New sector overlay → **DAB+CAB** via overlay RFC + **12** critical scenarios.               | Overlay causes > **10%** SLO regression in other sectors for 2 releases → freeze overlay.                                 | Pilot KPIs + zero criticals → Tier-A.                                                         | O-1/O-4/O-5 → E-02/E-13      | **G-S-01** Sector scenario pack; **G-S-02** Policy contract tests. Paths: `/rules/policy/*`, `/configs/sectors/*`, `/ui/design-system`                                  |
| **Sensor-Agnostic (SEN-AG)**            | **Conditional YES** (certified packs)                | **In:** LiDAR/radar/camera/IMU/GNSS; **Rugged-A** & **Urban-B** packs. **Out:** Unproven modalities in prod; ad-hoc mixes outside packs.                                                                                | Sensor HAL; time-sync daemon; calibration SOP; pack-bound perception models; latency/throughput budgets; **fail-silent** policy.                           | Perception p95 ≤ **60ms** (pack); precision/recall ≥ pack target; false-stop ≤ **1/2,000 km**; hot **pack swap** w/o app change.                                                                       | Pack datasets; confusion matrices; night/fog/dust suites; golden replays.                                                      | Vendor EOL → second source; calibration drift → scheduled recal + drift sentry.                                                             | New pack → **DAB+SAB** with model card, SOPs, KPI pass.                                     | ≥ **2** perception-attributable criticals/qtr → freeze pack.                                                              | 3 months KPI adherence across 2 sites → promote.                                              | O-1/O-3 → E-12               | **G-N-01** Pack KPI CI; **G-N-02** Calibration evidence. Paths: `/adapters/sensors/*`, `/ml/models/perception/*`, `/data/quality/drift`                                 |
| **Map-Source-Agnostic (MAP-AG)**        | **YES** (semantic contract + provenance)             | **In:** HERE/ESRI/OSM/custom site maps; **Lanelet2** (primary), **OpenDRIVE** (exchange); SLAM degrade mode (restricted). **Out:** Lane-semantics-lacking providers where required; proprietary formats w/o converters. | Map Data Contract; provenance signatures; conflict resolver (HITL escalation); versioned RoadGraph per trip; format validation.                            | Route correctness ≥ **99.x%** golden corridors; ETA median on target; conflict **MTTR ≤24h** (site) / **≤48h** (city); validation pass ≥ **99.5%**; conversion fidelity ≥ **99.9%** critical features. | Provider contract tests; route replay after updates; provenance in trip; format validation reports.                            | Staleness → credibility overrides; semantic gaps → augmentation layers; format mismatch → validated conversion utils.                       | New provider/format → **DAB+CAB** after contract+trial corridor pass.                       | Repeated breaches or fidelity < **99.5%** → disable provider/format.                                                      | < **0.1%** regressions over 6 months → lift restrictions; 3+ stable sources → promote format. | O-2/O-3/O-4 → E-08/E-05      | **G-M-01** Contract tests; **G-M-02** Route replay. Paths: `/services/map-service`, `/services/routing`, `/tools/map-{converter,validator}/*`, `/configs/map/formats/*` |
| **Weather-Source-Agnostic (WTH-AG)**    | **YES** (fusion with confidence & freshness budgets) | **In:** 1P local sensors, 2P site feeds, 3P met APIs; fusion; weather-aware routing/assist policies. **Out:** Blind majority voting; stale beyond TTL; operation outside ODD.                                           | Confidence model; freshness timeouts; fallback ladders; policy thresholds per sector; override with audit.                                                 | Weather incidents trend **↓ QoQ**; fusion availability ≥ **99.5%**; hindsight net-utility positive.                                                                                                    | Backtests vs ground truth; post-incident attribution; fusion model card.                                                       | Noisy sensors → robust stats/outlier filters; feed outages → cached nowcasts + redundancy.                                                  | New provider → **DAB+CAB** after 30-day shadow + calibration report.                        | Fusion negative utility 2 releases → pin to most credible feed.                                                           | 2 seasons with KPI gains → expand coverage.                                                   | O-1/O-3 → E-10/E-05          | **G-W-01** Fusion validation; **G-W-02** Freshness SLO. Paths: `/services/weather-fusion`, `/rules/policy`, `/services/routing`                                         |
| **Comms-Agnostic (COMMS-AG)**           | **YES** (multi-path + offline-first)                 | **In:** LTE/5G, Wi-Fi, SATCOM, mesh, V2X; store-and-forward; WAN-independent motion control. **Out:** WAN joystick driving; single-carrier dependence; unauth V2X.                                                      | Policy budgets (latency/jitter/cost); mTLS; V2X PKI + misbehavior detection; graceful degradation (assist→hints).                                          | Assist RTT p50 **<30s**, p95 **<90s**; handover ≥ **99%**; offline continuity ≥ **45m**; evidence upload **T+2h**.                                                                                     | Handover drills; failover chaos tests; upload completion logs.                                                                 | Coverage gaps → SATCOM/mesh fallback; cost spikes → policy cost caps; security → strict cert rotation/IDS.                                  | New carrier/mesh tech → **DAB+SAB** after field trials + security review.                   | Persistent RTT p95 breach or outages > SLA → disable costly path + re-tune.                                               | 3-month stability + cost within budget → broaden rollout.                                     | O-1/O-2/O-3 → E-11/E-09      | **G-C-01** Failover drills; **G-C-02** Assist RTT monitor. Paths: `/edge/vehicle-agent`, `/services/gateway-vehicle`, `/services/alerts-incident`                       |
| **Edge Stack Architecture (EDGE-ARCH)** | **YES** (ROS2 + containers)                          | **In:** ROS2 Humble/Iron, DDS, Ubuntu 22.04 LTS, Jetson Orin; componentized nodes; containerized deployment. **Out:** ROS1; custom middleware; non-containerized; direct HW bypassing HAL.                              | Real-time budgets; component isolation; message versioning; resource caps; safety verification for critical nodes.                                         | Control loop p95 ≤ **50ms**; CPU peak ≤ **70%** (avg ≤50%); mem leak **0**; node restart ≥ **99.9%**; boot ≤ **60s**.                                                                                  | Perf profiling; resource monitoring; fault injection; throughput tests; boot timing.                                           | Perf overhead → optimization; deps → containerization; version skew → pinning.                                                              | ROS2 upgrade/new node types → **DAB+SAB** after full test.                                  | Critical perf/safety targets missed; ROS2 support degrades → rollback/pin.                                                | Targets consistent across 3 vehicle types → expand features.                                  | O-1/O-2 → E-01/E-03/E-11     | **G-E-01** Edge perf CI; **G-E-02** Safety node verification. Paths: `/edge/ros2-core`, `/edge/vehicle-agent`, `/edge/diag-agent`, `/edge/cloud-bridge`                 |
| **Decision Framework (DECISIONS)**      | **YES** (BT core + safety rules + learned priors)    | **In:** Behavior trees; rule-based safety arbitrator; ML optimization priors; policy integration. **Out:** Pure-ML autonomy; pure rules for complex behaviors.                                                          | Deterministic critical paths; safety override; explainability; bounded ML outputs; perf budget adherence.                                                  | Decision p95 ≤ **40ms**; **0** safety violations; ≥ **15%** decision-quality lift vs baseline; resource ≤ **30%**; 100% explainable.                                                                   | Decision logs; visualizations; sim benchmarks; explainability reports; adaptation metrics.                                     | Complexity → visualization/docs; perf → optimize; integration → strict interfaces; validation → automation.                                 | New behaviors/ML updates/safety changes → **SAB+DAB** with formal verification pack.        | Safety arbitration failure or repeated p95 overruns → freeze changes.                                                     | Quality targets met + stable field performance → add behaviors.                               | O-1/O-3 → E-05/E-12          | **G-D-01** Decision latency CI; **G-D-02** Safety arbitrator proofs. Paths: `/edge/vehicle-agent/modules/decision/*`                                                    |
| **Simulation Strategy (SIM)**           | **YES** (multi-level CARLA+Gazebo, twin-gated CI)    | **In:** Unit→HIL; scenario bank; twin-gated CI; digital twins. **Out:** Single-sim standardization; custom sim dev.                                                                                                     | Scenario coverage %, fidelity standards, reproducibility, sim-to-real correlation checks.                                                                  | Coverage ≥ **95%**; sim-to-real ≥ **90%**; CI ≤ **4h**; detection ≥ **85%**; exec success ≥ **99.5%**; ≥ **2×** real-time in CI.                                                                       | Coverage analysis; correlation studies; pipeline metrics; RCA; logs; perf metrics.                                             | Sim gap → conservative margins + field tests; infra cost → optimization; maintenance → modular design.                                      | New simulator/models → **DAB+SAB** with validation suite.                                   | Correlation gap or CI time budget blown persistently → scope reduction.                                                   | Fidelity & detection targets met over 2 releases → widen bank.                                | O-1/O-2 → E-03/E-36          | **G-T-01** Twin gates; **G-T-02** Coverage reports. Paths: `/sim/{carla,gazebo}/`, `/sim/scenario-bank`, `/sim/ci-gates`                                                |
| **Compliance & Certifications (COMP)**  | **YES** (automated evidence, release-gated)          | **In:** ISO 26262, ISO 21448 (SOTIF), UNECE R155/R156, GDPR/CCPA; SOC2/ISO27001 where applicable. **Out:** Manual evidence as primary.                                                                                  | Evidence bundles per release; immutable audit logs; attested OTA; privacy purpose-binding; legal-hold controls.                                            | **100%** evidence completeness (gate); **0** audit gaps; OTA integrity 100%; DPIA coverage for PII flows.                                                                                              | Evidence index; audit trail integrity checks; OTA attestation; DPIA artifacts.                                                 | Evidence toil → CI automation; gaps → release block; jurisdiction variance → policy packs.                                                  | Standards scope or control changes → **CAB** sign-off; release blocks on gaps.              | Any audit gap or OTA integrity fail → immediate block/rollback.                                                           | Two clean audits + repeatable evidence over 2 releases → extend scope.                        | O-4/O-1 → E-04/E-29          | **G-CPL-01** Evidence completeness; **G-CPL-02** Audit integrity. Paths: `/compliance/*`, `/audit/*`, `/security/ota/*`, `/rules/privacy/*`                             |
| **Adapters & Partnerships (PARTNERS)**  | **YES** (contract-tested marketplace)                | **In:** ERP/WMS/TOS/mapping/carriers/OEMs via adapters; partner program tiers. **Out:** One-off brittle integrations.                                                                                                   | Adapter contracts; rate-limit/backoff; partner SLAs mirrored; versioned connectors.                                                                        | **100%** adapter contract tests; partner SLOs met; mean integration time ≤ **4 wks**.                                                                                                                  | Golden recordings; sandbox cert; error budget per adapter.                                                                     | API churn → contract test CI; vendor lock-in → multi-source strategy.                                                                       | New adapter → **DAB+CCB** after contract suite pass; partner tiering via **Partner Board**. | > **1%** error budget breach 2 releases → downgrade/replace partner.                                                      | 2+ customers using adapter with SLOs → Tier-A.                                                | O-2/O-3 → E-15/E-38          | **G-A-01** Contract test pass; **G-A-02** Error budget monitor. Paths: `/adapters/*`, `/partners/*`, `/ci/contract-tests`                                               |
| **SDKs & Design System (SDK/UI)**       | **YES** (OpenAPI-driven, versioned)                  | **In:** Python/JS SDKs; OpenAPI 3.x; design tokens; WCAG 2.2 AA. **Out:** Breaking changes without deprecation.                                                                                                         | 2 major versions supported; 6-month deprecations; a11y blocking gate; locale/i18n/RTL.                                                                     | API doc currency **100%** within 1 release; SUS ≥ **80**; TtFA ≤ **10 min**.                                                                                                                           | Doc pipeline checks; a11y audits; SDK conformance tests; usability studies.                                                    | Doc drift → auto-gen + gate; a11y regressions → CI axe; UX overload → progressive disclosure.                                               | API/UI breaking changes → **DAB** approval + deprecation plan.                              | Doc currency <100% or a11y fail → release block.                                                                          | 3 releases with clean gates → widen SDK surface.                                              | O-5/O-2 → E-13/E-72          | **G-U-01** API doc currency; **G-U-02** WCAG gate. Paths: `/openapi/*`, `/sdk/*`, `/ui/design-system`                                                                   |
| **Data Residency & Privacy (PRIV-RES)** | **YES** (policy-enforced residency)                  | **In:** In-region storage/processing for PII; purpose binding; redaction; legal holds; tenant/geo classification. **Out:** Cross-border PII without waiver.                                                             | Residency engine in pipeline; ABAC/RBAC; immutable logs; dual-approval exports; biometric flagged as Sensitive.                                            | **0** cross-border PII without waiver; **100%** purpose-binding on exports.                                                                                                                            | Residency assertions; export logs; DPIA/records of processing.                                                                 | Misconfig → policy checks; over-retention → automated purges; legal risk → DPO review.                                                      | Policy changes/jurisdiction updates → **CAB** review; runtime policy enforced.              | Any cross-border PII without waiver → immediate block & incident.                                                         | 2 quarters clean + customer audits passed → broaden automation.                               | O-4 → E-33                   | **G-PR-01** Residency checks; **G-PR-02** Export approval logs. Paths: `/data/policies/*`, `/privacy/*`, `/pipeline/*`                                                  |

---

### Enforcement Notes

* **CI/Twin Gates are hard blockers**: any **G-** gate failure blocks merge/release.
* **Bodies & Ownership** are explicit per row to avoid ambiguity (**CCB/SAB/DAB/CAB**).
* **Repo paths** point to the exact contracts, tests, and evidence folders that must exist and stay green.
* **Variant Budget** is enforced in CI: if agnostic variability pushes code/test deltas beyond thresholds, the pipeline fails and routes to **CCB** automatically.

---