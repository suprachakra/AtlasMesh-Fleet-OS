---
title: ROS2 Vehicle Agent - Node Graph
---
graph TB
    %% AtlasMesh Fleet OS - Edge stack ROS2 nodes and topic flows
    %% Version 1.0 | Generated from: ROS2 launch files + ros2 graph | Edge Stack
    %% ROS2 NODE GRAPH: Vehicle Agent edge stack architecture
    %% INTEGRATION CONTRACT: ROS2 Humble with DDS middleware
    %% SAFETY: Safety-critical nodes with redundancy and monitoring
    %% PERFORMANCE: Real-time constraints with QoS policies

    %% Safety Critical Nodes
    subgraph SAFETY["üö® SAFETY CRITICAL NODES"]
        SAFETY_MONITOR[üõ°Ô∏è safety_monitor<br/>**Safety Monitor Node**<br/>‚Ä¢ Monitors all system health<br/>‚Ä¢ Enforces safety constraints<br/>‚Ä¢ Triggers emergency stops<br/>‚Ä¢ Validates sensor data<br/>**QoS:** RELIABLE, KEEP_LAST 1<br/>**Frequency:** 100 Hz<br/>**Priority:** HIGHEST]
        
        EMERGENCY_STOP[üõë emergency_stop<br/>**Emergency Stop Node**<br/>‚Ä¢ Immediate brake activation<br/>‚Ä¢ Autonomy system shutdown<br/>‚Ä¢ Hazard light control<br/>‚Ä¢ Safe state enforcement<br/>**QoS:** RELIABLE, KEEP_LAST 1<br/>**Latency:** <10ms<br/>**Priority:** CRITICAL]
        
        WATCHDOG[üëÅÔ∏è watchdog<br/>**System Watchdog**<br/>‚Ä¢ Node health monitoring<br/>‚Ä¢ Heartbeat validation<br/>‚Ä¢ Automatic restart<br/>‚Ä¢ Failover coordination<br/>**QoS:** RELIABLE, KEEP_LAST 10<br/>**Frequency:** 10 Hz<br/>**Priority:** HIGH]
    end

    %% Perception Stack
    subgraph PERCEPTION["üîç PERCEPTION STACK"]
        LIDAR[üì° lidar_driver<br/>**LiDAR Driver**<br/>‚Ä¢ Point cloud generation<br/>‚Ä¢ Obstacle detection<br/>‚Ä¢ Range measurements<br/>‚Ä¢ Calibration management<br/>**QoS:** BEST_EFFORT, KEEP_LAST 3<br/>**Frequency:** 20 Hz<br/>**Data:** PointCloud2]
        
        CAMERA[üì∑ camera_driver<br/>**Camera Driver**<br/>‚Ä¢ Image capture<br/>‚Ä¢ Lane detection<br/>‚Ä¢ Traffic sign recognition<br/>‚Ä¢ Object classification<br/>**QoS:** BEST_EFFORT, KEEP_LAST 5<br/>**Frequency:** 30 Hz<br/>**Data:** Image, CompressedImage]
        
        RADAR[üì∂ radar_driver<br/>**Radar Driver**<br/>‚Ä¢ Velocity measurements<br/>‚Ä¢ Weather-robust detection<br/>‚Ä¢ Long-range sensing<br/>‚Ä¢ Doppler analysis<br/>**QoS:** RELIABLE, KEEP_LAST 3<br/>**Frequency:** 25 Hz<br/>**Data:** RadarScan]
        
        SENSOR_FUSION[üîÑ sensor_fusion<br/>**Sensor Fusion**<br/>‚Ä¢ Multi-sensor integration<br/>‚Ä¢ Kalman filtering<br/>‚Ä¢ Uncertainty quantification<br/>‚Ä¢ Confidence scoring<br/>**QoS:** RELIABLE, KEEP_LAST 1<br/>**Frequency:** 50 Hz<br/>**Algorithm:** Extended Kalman Filter]
        
        PERCEPTION_PIPELINE[üß† perception_pipeline<br/>**Perception Pipeline**<br/>‚Ä¢ Object tracking<br/>‚Ä¢ Semantic segmentation<br/>‚Ä¢ Depth estimation<br/>‚Ä¢ Scene understanding<br/>**QoS:** RELIABLE, KEEP_LAST 1<br/>**Frequency:** 20 Hz<br/>**ML Models:** YOLO, SegNet]
    end

    %% Control Stack
    subgraph CONTROL["üéÆ CONTROL STACK"]
        LOCALIZATION[üó∫Ô∏è localization<br/>**Localization Node**<br/>‚Ä¢ GNSS/IMU fusion<br/>‚Ä¢ Map matching<br/>‚Ä¢ Pose estimation<br/>‚Ä¢ Coordinate transforms<br/>**QoS:** RELIABLE, KEEP_LAST 1<br/>**Frequency:** 100 Hz<br/>**Accuracy:** <10cm]
        
        PATH_PLANNER[üõ§Ô∏è path_planner<br/>**Path Planner**<br/>‚Ä¢ Route optimization<br/>‚Ä¢ Obstacle avoidance<br/>‚Ä¢ Traffic rule compliance<br/>‚Ä¢ Dynamic re-planning<br/>**QoS:** RELIABLE, KEEP_LAST 1<br/>**Frequency:** 10 Hz<br/>**Algorithm:** A*, RRT*]
        
        MOTION_CONTROLLER[üéØ motion_controller<br/>**Motion Controller**<br/>‚Ä¢ Trajectory following<br/>‚Ä¢ Speed regulation<br/>‚Ä¢ Steering control<br/>‚Ä¢ Brake management<br/>**QoS:** RELIABLE, KEEP_LAST 1<br/>**Frequency:** 100 Hz<br/>**Control:** PID, MPC]
        
        VEHICLE_INTERFACE[üîå vehicle_interface<br/>**Vehicle Interface**<br/>‚Ä¢ CAN bus communication<br/>‚Ä¢ Actuator commands<br/>‚Ä¢ Sensor data collection<br/>‚Ä¢ Hardware abstraction<br/>**QoS:** RELIABLE, KEEP_LAST 1<br/>**Frequency:** 1000 Hz<br/>**Protocol:** CAN, Ethernet]
    end

    %% Communication Stack
    subgraph COMMUNICATION["üì° COMMUNICATION STACK"]
        FLEET_GATEWAY[üåê fleet_gateway<br/>**Fleet Gateway**<br/>‚Ä¢ WebSocket client<br/>‚Ä¢ Command processing<br/>‚Ä¢ Telemetry transmission<br/>‚Ä¢ Status reporting<br/>**QoS:** RELIABLE, KEEP_LAST 10<br/>**Frequency:** 10 Hz<br/>**Protocol:** WebSocket, MQTT]
        
        V2X_COMM[üìª v2x_communication<br/>**V2X Communication**<br/>‚Ä¢ Vehicle-to-vehicle V2V<br/>‚Ä¢ Vehicle-to-infrastructure V2I<br/>‚Ä¢ DSRC/5G connectivity<br/>‚Ä¢ Cooperative awareness<br/>**QoS:** BEST_EFFORT, KEEP_LAST 5<br/>**Frequency:** 10 Hz<br/>**Standard:** IEEE 802.11p]
        
        TELEMETRY_COLLECTOR[üìä telemetry_collector<br/>**Telemetry Collector**<br/>‚Ä¢ Data aggregation<br/>‚Ä¢ Compression<br/>‚Ä¢ Buffering<br/>‚Ä¢ Transmission scheduling<br/>**QoS:** RELIABLE, KEEP_LAST 100<br/>**Frequency:** 1 Hz<br/>**Compression:** LZ4]
    end

    %% Monitoring Stack
    subgraph MONITORING["üìà MONITORING STACK"]
        DIAGNOSTICS[üîß diagnostics<br/>**Diagnostics Node**<br/>‚Ä¢ System health monitoring<br/>‚Ä¢ Performance metrics<br/>‚Ä¢ Error detection<br/>‚Ä¢ Log aggregation<br/>**QoS:** RELIABLE, KEEP_LAST 50<br/>**Frequency:** 1 Hz<br/>**Metrics:** CPU, Memory, Network]
        
        DATA_RECORDER[üíæ data_recorder<br/>**Data Recorder**<br/>‚Ä¢ ROS bag recording<br/>‚Ä¢ Selective logging<br/>‚Ä¢ Compression<br/>‚Ä¢ Storage management<br/>**QoS:** BEST_EFFORT, KEEP_LAST 1<br/>**Storage:** 500GB SSD<br/>**Retention:** 7 days]
    end

    %% ROS2 Topic Flows (Safety Critical)
    SAFETY_MONITOR -->|/emergency_stop<br/>{trigger, reason}| EMERGENCY_STOP
    WATCHDOG -->|/node_health<br/>{status, heartbeat}| SAFETY_MONITOR
    EMERGENCY_STOP -->|/brake_command<br/>{force, immediate}| VEHICLE_INTERFACE

    %% Perception Topic Flows
    LIDAR -->|/lidar/points<br/>PointCloud2| SENSOR_FUSION
    CAMERA -->|/camera/image<br/>Image| SENSOR_FUSION
    RADAR -->|/radar/scan<br/>RadarScan| SENSOR_FUSION
    SENSOR_FUSION -->|/fused_objects<br/>ObjectArray| PERCEPTION_PIPELINE
    PERCEPTION_PIPELINE -->|/detected_objects<br/>ObjectArray| PATH_PLANNER

    %% Control Topic Flows
    LOCALIZATION -->|/current_pose<br/>PoseWithCovariance| PATH_PLANNER
    PATH_PLANNER -->|/planned_path<br/>Path| MOTION_CONTROLLER
    MOTION_CONTROLLER -->|/control_commands<br/>Twist| VEHICLE_INTERFACE
    VEHICLE_INTERFACE -->|/vehicle_state<br/>Odometry| LOCALIZATION

    %% Communication Topic Flows
    FLEET_GATEWAY -->|/fleet_commands<br/>VehicleCommand| MOTION_CONTROLLER
    TELEMETRY_COLLECTOR -->|/vehicle_telemetry<br/>TelemetryMsg| FLEET_GATEWAY
    V2X_COMM -->|/v2x_objects<br/>ObjectArray| PERCEPTION_PIPELINE

    %% Monitoring Topic Flows
    DIAGNOSTICS -->|/diagnostics<br/>DiagnosticArray| TELEMETRY_COLLECTOR
    DATA_RECORDER -->|/rosbag_status<br/>BagStatus| DATA_RECORDER

    %% Cross-cutting Topic Flows
    SAFETY_MONITOR -->|/safety_status<br/>SafetyStatus| TELEMETRY_COLLECTOR
    WATCHDOG -->|/system_health<br/>SystemHealth| DIAGNOSTICS
    SENSOR_FUSION -->|/sensor_status<br/>SensorStatus| TELEMETRY_COLLECTOR

    %% Topic Annotations
    subgraph TOPICS["üìã ROS2 TOPIC CATEGORIES"]
        SAFETY_TOPICS[üö® **SAFETY CRITICAL TOPICS:**<br/>‚Ä¢ /emergency_stop - Immediate brake activation<br/>‚Ä¢ /safety_status - Continuous safety monitoring<br/>‚Ä¢ /system_health - Node health validation<br/>‚Ä¢ All safety topics use RELIABLE QoS]
        
        PERCEPTION_TOPICS[üëÅÔ∏è **PERCEPTION TOPICS:**<br/>‚Ä¢ /lidar/points - 3D point clouds 20Hz<br/>‚Ä¢ /camera/image - RGB images 30Hz<br/>‚Ä¢ /radar/scan - Radar detections 25Hz<br/>‚Ä¢ /fused_objects - Sensor fusion output 50Hz]
        
        CONTROL_TOPICS[üéÆ **CONTROL TOPICS:**<br/>‚Ä¢ /planned_path - Trajectory waypoints 10Hz<br/>‚Ä¢ /control_commands - Actuator commands 100Hz<br/>‚Ä¢ /current_pose - Vehicle localization 100Hz<br/>‚Ä¢ All control topics use RELIABLE QoS]
        
        COMM_TOPICS[üì° **COMMUNICATION TOPICS:**<br/>‚Ä¢ /fleet_commands - Commands from fleet async<br/>‚Ä¢ /vehicle_telemetry - Status to fleet 10Hz<br/>‚Ä¢ /v2x_objects - V2X cooperative data 10Hz<br/>‚Ä¢ WebSocket and MQTT protocols supported]
    end

    %% Deployment Configuration
    subgraph DEPLOYMENT["üöÄ DEPLOYMENT CONFIGURATION"]
        CONFIG[üìã **DEPLOYMENT NOTES:**<br/>‚Ä¢ ROS2 Humble LTS on Ubuntu 22.04<br/>‚Ä¢ DDS Middleware: Fast-DDS default<br/>‚Ä¢ Real-time kernel for control nodes<br/>‚Ä¢ Docker containers for isolation<br/>‚Ä¢ systemd services for auto-start<br/>‚Ä¢ Resource limits per node<br/>‚Ä¢ CPU affinity for critical nodes]
    end

    %% Styling
    classDef safetyCritical fill:#ff4757,stroke:#d63031,stroke-width:3px,color:#fff
    classDef perception fill:#3742fa,stroke:#2f3542,stroke-width:2px,color:#fff
    classDef control fill:#2ed573,stroke:#1dd1a1,stroke-width:2px,color:#fff
    classDef communication fill:#ffa502,stroke:#ff6348,stroke-width:2px,color:#fff
    classDef monitoring fill:#747d8c,stroke:#57606f,stroke-width:2px,color:#fff
    classDef topics fill:#a4b0be,stroke:#747d8c,stroke-width:1px
    classDef deployment fill:#5f27cd,stroke:#341f97,stroke-width:2px,color:#fff

    class SAFETY_MONITOR,EMERGENCY_STOP,WATCHDOG safetyCritical
    class LIDAR,CAMERA,RADAR,SENSOR_FUSION,PERCEPTION_PIPELINE perception
    class LOCALIZATION,PATH_PLANNER,MOTION_CONTROLLER,VEHICLE_INTERFACE control
    class FLEET_GATEWAY,V2X_COMM,TELEMETRY_COLLECTOR communication
    class DIAGNOSTICS,DATA_RECORDER monitoring
    class SAFETY_TOPICS,PERCEPTION_TOPICS,CONTROL_TOPICS,COMM_TOPICS topics
    class CONFIG deployment
