{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://schemas.atlasmesh.ai/core-entities/v1.0.0",
  "title": "AtlasMesh Fleet OS - Core Entity Schemas",
  "description": "Foundational data schemas for the AtlasMesh Fleet Operating System",
  
  "$defs": {
    "Trip": {
      "type": "object",
      "title": "Trip Entity",
      "description": "Core trip entity with full lifecycle tracking",
      "required": ["id", "tenant_id", "sector", "type", "status", "created_at", "schedule"],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid",
          "description": "Unique trip identifier"
        },
        "tenant_id": {
          "type": "string", 
          "format": "uuid",
          "description": "Tenant/customer identifier for multi-tenancy"
        },
        "sector": {
          "$ref": "#/$defs/Sector"
        },
        "type": {
          "$ref": "#/$defs/TripType"
        },
        "status": {
          "$ref": "#/$defs/TripStatus"
        },
        "priority": {
          "type": "integer",
          "minimum": 1,
          "maximum": 10,
          "default": 5,
          "description": "Trip priority (1=lowest, 10=highest)"
        },
        "vehicle_id": {
          "type": "string",
          "description": "Assigned vehicle identifier",
          "nullable": true
        },
        "operator_id": {
          "type": "string",
          "format": "uuid",
          "description": "Assigned operator identifier",
          "nullable": true
        },
        "schedule": {
          "$ref": "#/$defs/Schedule"
        },
        "route": {
          "$ref": "#/$defs/Route",
          "nullable": true
        },
        "manifest": {
          "$ref": "#/$defs/TripManifest"
        },
        "policy_pack_id": {
          "type": "string",
          "description": "Applied policy pack identifier"
        },
        "map_version": {
          "type": "string",
          "description": "Map snapshot version used for this trip"
        },
        "odd_constraints": {
          "$ref": "#/$defs/ODDConstraints"
        },
        "state_history": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/StateTransition"
          },
          "description": "Complete state transition history"
        },
        "estimated_duration_minutes": {
          "type": "integer",
          "minimum": 0
        },
        "actual_duration_minutes": {
          "type": "integer",
          "minimum": 0,
          "nullable": true
        },
        "estimated_distance_meters": {
          "type": "integer",
          "minimum": 0
        },
        "actual_distance_meters": {
          "type": "integer",
          "minimum": 0,
          "nullable": true
        },
        "created_at": {
          "type": "string",
          "format": "date-time"
        },
        "updated_at": {
          "type": "string",
          "format": "date-time"
        },
        "scheduled_start": {
          "type": "string",
          "format": "date-time"
        },
        "actual_start": {
          "type": "string",
          "format": "date-time",
          "nullable": true
        },
        "completed_at": {
          "type": "string",
          "format": "date-time",
          "nullable": true
        }
      },
      "additionalProperties": false
    },

    "Vehicle": {
      "type": "object",
      "title": "Vehicle Entity", 
      "description": "Complete vehicle entity with capabilities and state",
      "required": ["id", "tenant_id", "type", "status", "capability_manifest", "created_at"],
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique vehicle identifier"
        },
        "tenant_id": {
          "type": "string",
          "format": "uuid"
        },
        "type": {
          "type": "string",
          "description": "Vehicle type (e.g., ugv_themis, haul_truck_cat)"
        },
        "model": {
          "type": "string",
          "description": "Vehicle model name"
        },
        "manufacturer": {
          "type": "string"
        },
        "vin": {
          "type": "string",
          "description": "Vehicle Identification Number"
        },
        "license_plate": {
          "type": "string"
        },
        "status": {
          "$ref": "#/$defs/VehicleStatus"
        },
        "operational_state": {
          "$ref": "#/$defs/OperationalState"
        },
        "capability_manifest": {
          "$ref": "#/$defs/CapabilityManifest"
        },
        "current_location": {
          "$ref": "#/$defs/Location",
          "nullable": true
        },
        "home_base": {
          "$ref": "#/$defs/Location"
        },
        "communication_status": {
          "type": "string",
          "enum": ["connected", "degraded", "offline"]
        },
        "last_heartbeat": {
          "type": "string",
          "format": "date-time"
        },
        "battery_level": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "nullable": true,
          "description": "Battery level percentage"
        },
        "fuel_level": {
          "type": "integer", 
          "minimum": 0,
          "maximum": 100,
          "nullable": true,
          "description": "Fuel level percentage"
        },
        "range_remaining_km": {
          "type": "number",
          "minimum": 0,
          "nullable": true
        },
        "odometer_km": {
          "type": "number",
          "minimum": 0,
          "description": "Total odometer reading in kilometers"
        },
        "autonomous_km": {
          "type": "number", 
          "minimum": 0,
          "description": "Kilometers driven in autonomous mode"
        },
        "total_trips": {
          "type": "integer",
          "minimum": 0
        },
        "active_trip_id": {
          "type": "string",
          "format": "uuid",
          "nullable": true
        },
        "next_maintenance_km": {
          "type": "number",
          "minimum": 0
        },
        "next_maintenance_date": {
          "type": "string",
          "format": "date"
        },
        "maintenance_status": {
          "type": "string",
          "enum": ["current", "due_soon", "overdue", "in_maintenance"]
        },
        "permits": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/Permit"
          }
        },
        "software_version": {
          "type": "string"
        },
        "firmware_version": {
          "type": "string" 
        },
        "map_version": {
          "type": "string"
        },
        "created_at": {
          "type": "string",
          "format": "date-time"
        },
        "updated_at": {
          "type": "string",
          "format": "date-time"
        },
        "last_active": {
          "type": "string",
          "format": "date-time"
        }
      },
      "additionalProperties": false
    },

    "CapabilityManifest": {
      "type": "object",
      "title": "Vehicle Capability Manifest",
      "description": "Defines what a vehicle can and cannot do - critical for agnostic dispatch",
      "required": ["vehicle_class", "max_speed", "drive_by_wire", "sensors", "compute", "power"],
      "properties": {
        "vehicle_class": {
          "type": "string",
          "enum": ["ugv", "sedan", "suv", "truck", "bus", "construction", "mining", "military"]
        },
        "dimensions": {
          "$ref": "#/$defs/VehicleDimensions"
        },
        "weight": {
          "$ref": "#/$defs/WeightCapacity"
        },
        "max_speed": {
          "type": "integer",
          "minimum": 1,
          "maximum": 200,
          "description": "Maximum speed in km/h"
        },
        "max_payload": {
          "type": "integer",
          "minimum": 0,
          "description": "Maximum payload in kg"
        },
        "max_grade": {
          "type": "integer",
          "minimum": 0,
          "maximum": 60,
          "description": "Maximum grade in degrees"
        },
        "drive_by_wire": {
          "$ref": "#/$defs/DriveByWireCapabilities"
        },
        "sensors": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/SensorSpec"
          },
          "minItems": 1
        },
        "compute": {
          "$ref": "#/$defs/ComputeSpec"
        },
        "power": {
          "$ref": "#/$defs/PowerSpec"
        },
        "operating_conditions": {
          "$ref": "#/$defs/OperatingConditions"
        },
        "supported_odds": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["urban", "highway", "mining_site", "port_yard", "military_base", "construction_site"]
          }
        },
        "certifications": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "safety_integrity_level": {
          "type": "string",
          "enum": ["sil1", "sil2", "sil3", "sil4"]
        }
      },
      "additionalProperties": false
    },

    "Event": {
      "type": "object",
      "title": "System Event",
      "description": "Unified event model for all system events with taxonomy",
      "required": ["id", "timestamp", "type", "severity", "source"],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "timestamp": {
          "type": "string",
          "format": "date-time"
        },
        "type": {
          "$ref": "#/$defs/EventType"
        },
        "severity": {
          "$ref": "#/$defs/EventSeverity"
        },
        "source": {
          "$ref": "#/$defs/EventSource"
        },
        "vehicle_id": {
          "type": "string",
          "nullable": true
        },
        "trip_id": {
          "type": "string",
          "format": "uuid",
          "nullable": true
        },
        "operator_id": {
          "type": "string",
          "format": "uuid", 
          "nullable": true
        },
        "title": {
          "type": "string",
          "maxLength": 200
        },
        "description": {
          "type": "string",
          "maxLength": 2000
        },
        "data": {
          "type": "object",
          "description": "Event-specific data payload",
          "additionalProperties": true
        },
        "tags": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "location": {
          "$ref": "#/$defs/Location",
          "nullable": true
        },
        "acknowledged": {
          "type": "boolean",
          "default": false
        },
        "acknowledged_by": {
          "type": "string",
          "format": "uuid",
          "nullable": true
        },
        "acknowledged_at": {
          "type": "string",
          "format": "date-time",
          "nullable": true
        },
        "resolved": {
          "type": "boolean",
          "default": false
        },
        "resolved_at": {
          "type": "string",
          "format": "date-time",
          "nullable": true
        },
        "parent_event_id": {
          "type": "string",
          "format": "uuid",
          "nullable": true,
          "description": "For event chains/causality"
        }
      },
      "additionalProperties": false
    },

    "Permit": {
      "type": "object",
      "title": "Vehicle Permit",
      "description": "Legal/regulatory permits required for vehicle operation",
      "required": ["id", "type", "jurisdiction", "valid_from", "valid_to", "status"],
      "properties": {
        "id": {
          "type": "string"
        },
        "type": {
          "type": "string",
          "enum": ["operating", "safety", "environmental", "customs", "special_transport", "defense_clearance"]
        },
        "jurisdiction": {
          "type": "string",
          "description": "Issuing jurisdiction (e.g., 'AE-AZ' for Abu Dhabi)"
        },
        "valid_from": {
          "type": "string",
          "format": "date"
        },
        "valid_to": {
          "type": "string",
          "format": "date"
        },
        "status": {
          "type": "string",
          "enum": ["active", "expired", "suspended", "pending_renewal", "cancelled"]
        },
        "restrictions": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Operating restrictions or conditions"
        },
        "issuing_authority": {
          "type": "string"
        },
        "permit_number": {
          "type": "string"
        },
        "renewal_required_days": {
          "type": "integer",
          "minimum": 0,
          "description": "Days before expiry when renewal is required"
        }
      },
      "additionalProperties": false
    },

    "SIM": {
      "type": "object",
      "title": "SIM Card",
      "description": "Vehicle connectivity SIM card information",
      "required": ["sim_id", "iccid", "status", "carrier"],
      "properties": {
        "sim_id": {
          "type": "string"
        },
        "iccid": {
          "type": "string",
          "pattern": "^[0-9]{19,22}$",
          "description": "Integrated Circuit Card Identifier"
        },
        "msisdn": {
          "type": "string",
          "nullable": true,
          "description": "Phone number if applicable"
        },
        "carrier": {
          "type": "string"
        },
        "apn": {
          "type": "string",
          "description": "Access Point Name"
        },
        "plan": {
          "type": "string",
          "description": "Data plan type"
        },
        "status": {
          "type": "string",
          "enum": ["active", "suspended", "expired", "terminated"]
        },
        "data_usage_mb": {
          "type": "number",
          "minimum": 0,
          "description": "Current month data usage in MB"
        },
        "data_limit_mb": {
          "type": "number", 
          "minimum": 0,
          "nullable": true
        },
        "signal_strength_dbm": {
          "type": "integer",
          "nullable": true
        },
        "network_type": {
          "type": "string",
          "enum": ["2G", "3G", "4G", "5G", "unknown"],
          "nullable": true
        },
        "last_connected": {
          "type": "string",
          "format": "date-time"
        }
      },
      "additionalProperties": false
    },

    "PolicyPack": {
      "type": "object",
      "title": "Policy Pack",
      "description": "Versioned policy configuration for different contexts",
      "required": ["id", "name", "version", "sector", "active"],
      "properties": {
        "id": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "version": {
          "type": "string",
          "pattern": "^\\d+\\.\\d+\\.\\d+$"
        },
        "sector": {
          "$ref": "#/$defs/Sector"
        },
        "city": {
          "type": "string",
          "nullable": true,
          "description": "City-specific policies"
        },
        "tenant_id": {
          "type": "string",
          "format": "uuid",
          "nullable": true
        },
        "active": {
          "type": "boolean"
        },
        "precedence_level": {
          "type": "string",
          "enum": ["safety", "regulatory", "tenant", "sector", "city", "fleet", "experimental"]
        },
        "policies": {
          "type": "object",
          "additionalProperties": true,
          "description": "Policy rules and parameters"
        },
        "created_at": {
          "type": "string",
          "format": "date-time"
        },
        "valid_from": {
          "type": "string",
          "format": "date-time"
        },
        "valid_to": {
          "type": "string", 
          "format": "date-time",
          "nullable": true
        }
      },
      "additionalProperties": false
    },

    "GaragePC": {
      "type": "object", 
      "title": "Garage PC",
      "description": "Physical garage PC for vehicle servicing and data management",
      "required": ["pc_id", "hostname", "status", "slots"],
      "properties": {
        "pc_id": {
          "type": "string"
        },
        "hostname": {
          "type": "string"
        },
        "location": {
          "$ref": "#/$defs/Location"
        },
        "status": {
          "type": "string",
          "enum": ["online", "offline", "maintenance", "error"]
        },
        "agent_version": {
          "type": "string"
        },
        "os_info": {
          "type": "object",
          "properties": {
            "os": {"type": "string"},
            "version": {"type": "string"},
            "arch": {"type": "string"}
          }
        },
        "hardware_info": {
          "type": "object",
          "properties": {
            "cpu_cores": {"type": "integer"},
            "memory_gb": {"type": "integer"},
            "storage_gb": {"type": "integer"},
            "gpu": {"type": "string", "nullable": true}
          }
        },
        "slots": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/GarageSlot"
          }
        },
        "network_interfaces": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/NetworkInterface"
          }
        },
        "last_heartbeat": {
          "type": "string",
          "format": "date-time"
        },
        "uptime_seconds": {
          "type": "integer",
          "minimum": 0
        },
        "temperature_celsius": {
          "type": "number",
          "nullable": true
        }
      },
      "additionalProperties": false
    },

    "GarageSlot": {
      "type": "object",
      "title": "Garage Slot",
      "description": "Individual storage slot in garage PC",
      "required": ["slot_id", "type", "status"],
      "properties": {
        "slot_id": {
          "type": "string"
        },
        "type": {
          "type": "string",
          "enum": ["ssd", "hdd", "nvme", "usb", "unknown"]
        },
        "status": {
          "type": "string",
          "enum": ["empty", "occupied", "ejecting", "error", "unknown"]
        },
        "device_info": {
          "type": "object",
          "nullable": true,
          "properties": {
            "model": {"type": "string"},
            "serial": {"type": "string"},
            "capacity_gb": {"type": "integer"},
            "used_gb": {"type": "integer"},
            "health": {"type": "string", "enum": ["good", "warning", "critical", "unknown"]},
            "smart_status": {"type": "string"}
          }
        },
        "last_activity": {
          "type": "string",
          "format": "date-time",
          "nullable": true
        },
        "vehicle_id": {
          "type": "string",
          "nullable": true,
          "description": "If occupied, which vehicle's data is stored"
        }
      },
      "additionalProperties": false
    },

    "Sector": {
      "type": "string",
      "enum": ["defense", "mining", "logistics", "ride_hail"],
      "description": "Industry sector classification"
    },

    "TripType": {
      "type": "string",
      "enum": [
        "release_run",
        "operation_run", 
        "mapping_run",
        "calibration",
        "passenger_ride_solo",
        "passenger_ride_shared", 
        "delivery",
        "logistics_run",
        "yard_move",
        "reposition",
        "maintenance", 
        "charging",
        "emergency",
        "recovery",
        "training",
        "validation"
      ]
    },

    "TripStatus": {
      "type": "string",
      "enum": [
        "draft",
        "scheduled", 
        "queued",
        "assigned",
        "en_route",
        "on_trip",
        "paused",
        "awaiting_assist",
        "charging",
        "error", 
        "safe_stopped",
        "completed",
        "expired",
        "cancelled",
        "aborted"
      ]
    },

    "VehicleStatus": {
      "type": "string", 
      "enum": ["provisioning", "healthy", "degraded", "standby", "maintenance", "retired", "unknown"]
    },

    "OperationalState": {
      "type": "string",
      "enum": ["idle", "assigned", "in_transit", "charging", "maintenance", "emergency"]
    },

    "EventType": {
      "type": "string",
      "enum": [
        "heartbeat",
        "state_change",
        "fault",
        "maintenance",
        "safety",
        "operational", 
        "diagnostic",
        "communication",
        "policy",
        "security",
        "user_action"
      ]
    },

    "EventSeverity": {
      "type": "string",
      "enum": ["info", "warning", "error", "critical"]
    },

    "EventSource": {
      "type": "object",
      "required": ["component", "instance"],
      "properties": {
        "component": {
          "type": "string",
          "description": "System component that generated the event"
        },
        "instance": {
          "type": "string", 
          "description": "Specific instance identifier"
        },
        "version": {
          "type": "string",
          "nullable": true
        }
      }
    },

    "Location": {
      "type": "object",
      "required": ["latitude", "longitude"],
      "properties": {
        "latitude": {
          "type": "number",
          "minimum": -90,
          "maximum": 90
        },
        "longitude": {
          "type": "number",
          "minimum": -180,
          "maximum": 180
        },
        "altitude": {
          "type": "number",
          "nullable": true
        },
        "accuracy": {
          "type": "number",
          "minimum": 0,
          "nullable": true
        },
        "heading": {
          "type": "number", 
          "minimum": 0,
          "maximum": 360,
          "nullable": true
        },
        "address": {
          "type": "string",
          "nullable": true
        },
        "city": {
          "type": "string",
          "nullable": true
        },
        "region": {
          "type": "string",
          "nullable": true
        },
        "country": {
          "type": "string",
          "nullable": true
        }
      },
      "additionalProperties": false
    },

    "Schedule": {
      "type": "object",
      "required": ["start_time"],
      "properties": {
        "start_time": {
          "type": "string",
          "format": "date-time"
        },
        "end_time": {
          "type": "string",
          "format": "date-time",
          "nullable": true
        },
        "duration_minutes": {
          "type": "integer",
          "minimum": 1,
          "nullable": true
        },
        "timezone": {
          "type": "string",
          "default": "UTC"
        },
        "recurrence": {
          "$ref": "#/$defs/RecurrencePattern"
        }
      }
    },

    "RecurrencePattern": {
      "type": "object",
      "nullable": true,
      "properties": {
        "pattern": {
          "type": "string",
          "enum": ["daily", "weekly", "monthly"]
        },
        "interval": {
          "type": "integer",
          "minimum": 1
        },
        "end_date": {
          "type": "string",
          "format": "date",
          "nullable": true
        },
        "occurrences": {
          "type": "integer",
          "minimum": 1,
          "nullable": true
        }
      }
    },

    "Route": {
      "type": "object",
      "required": ["start_location", "end_location"],
      "properties": {
        "start_location": {
          "$ref": "#/$defs/Location"
        },
        "end_location": {
          "$ref": "#/$defs/Location"
        },
        "waypoints": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/Waypoint"
          }
        },
        "estimated_duration_minutes": {
          "type": "integer",
          "minimum": 0
        },
        "estimated_distance_meters": {
          "type": "integer", 
          "minimum": 0
        },
        "estimated_energy_consumption": {
          "type": "number",
          "minimum": 0,
          "description": "Estimated energy consumption in kWh or L"
        },
        "map_version": {
          "type": "string"
        },
        "route_confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        }
      }
    },

    "Waypoint": {
      "allOf": [
        {"$ref": "#/$defs/Location"},
        {
          "type": "object",
          "properties": {
            "stop_duration_minutes": {
              "type": "integer",
              "minimum": 0,
              "default": 0
            },
            "arrival_window": {
              "$ref": "#/$defs/TimeWindow"
            },
            "required": {
              "type": "boolean",
              "default": true
            }
          }
        }
      ]
    },

    "TimeWindow": {
      "type": "object",
      "properties": {
        "earliest": {
          "type": "string",
          "format": "date-time"
        },
        "latest": {
          "type": "string",
          "format": "date-time"
        }
      }
    },

    "TripManifest": {
      "type": "object",
      "properties": {
        "description": {
          "type": "string",
          "maxLength": 500
        },
        "cargo": {
          "$ref": "#/$defs/CargoManifest"
        },
        "passengers": {
          "$ref": "#/$defs/PassengerManifest"
        },
        "special_requirements": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["medical_equipment", "hazmat", "oversized", "refrigerated", "security_escort", "classified"]
          }
        },
        "operator_notes": {
          "type": "string",
          "maxLength": 1000
        },
        "customer_reference": {
          "type": "string",
          "nullable": true
        },
        "billing_code": {
          "type": "string",
          "nullable": true
        }
      }
    },

    "CargoManifest": {
      "type": "object",
      "nullable": true,
      "properties": {
        "items": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/CargoItem"
          }
        },
        "total_weight_kg": {
          "type": "number",
          "minimum": 0
        },
        "total_volume_m3": {
          "type": "number", 
          "minimum": 0
        }
      }
    },

    "CargoItem": {
      "type": "object",
      "required": ["description", "weight_kg"],
      "properties": {
        "description": {
          "type": "string"
        },
        "weight_kg": {
          "type": "number",
          "minimum": 0
        },
        "dimensions": {
          "$ref": "#/$defs/Dimensions"
        },
        "hazmat_class": {
          "type": "string",
          "nullable": true
        },
        "value": {
          "type": "number",
          "minimum": 0,
          "nullable": true
        },
        "fragile": {
          "type": "boolean",
          "default": false
        }
      }
    },

    "PassengerManifest": {
      "type": "object",
      "nullable": true,
      "properties": {
        "capacity": {
          "type": "integer",
          "minimum": 1
        },
        "booked": {
          "type": "integer",
          "minimum": 0
        },
        "wheelchair_accessible": {
          "type": "boolean",
          "default": false
        },
        "child_seats": {
          "type": "integer",
          "minimum": 0,
          "default": 0
        }
      }
    },

    "Dimensions": {
      "type": "object",
      "required": ["length_m", "width_m", "height_m"],
      "properties": {
        "length_m": {
          "type": "number",
          "minimum": 0
        },
        "width_m": {
          "type": "number",
          "minimum": 0
        },
        "height_m": {
          "type": "number",
          "minimum": 0
        }
      }
    },

    "ODDConstraints": {
      "type": "object",
      "nullable": true,
      "properties": {
        "max_temperature_c": {
          "type": "integer"
        },
        "min_visibility_m": {
          "type": "integer",
          "minimum": 0
        },
        "max_wind_speed_kmh": {
          "type": "integer",
          "minimum": 0
        },
        "max_precipitation_mmh": {
          "type": "integer",
          "minimum": 0
        },
        "required_road_quality": {
          "type": "string",
          "enum": ["paved", "gravel", "dirt", "off_road"]
        },
        "gps_required": {
          "type": "boolean",
          "default": true
        }
      }
    },

    "StateTransition": {
      "type": "object",
      "required": ["from_status", "to_status", "timestamp"],
      "properties": {
        "from_status": {
          "$ref": "#/$defs/TripStatus"
        },
        "to_status": {
          "$ref": "#/$defs/TripStatus"
        },
        "timestamp": {
          "type": "string",
          "format": "date-time"
        },
        "reason": {
          "type": "string",
          "nullable": true
        },
        "triggered_by": {
          "type": "string",
          "enum": ["system", "operator", "policy", "vehicle", "weather", "emergency"]
        },
        "details": {
          "type": "object",
          "additionalProperties": true,
          "nullable": true
        }
      }
    },

    "VehicleDimensions": {
      "type": "object",
      "required": ["length", "width", "height"],
      "properties": {
        "length": {
          "type": "number",
          "minimum": 0,
          "description": "Length in meters"
        },
        "width": {
          "type": "number",
          "minimum": 0,
          "description": "Width in meters"
        },
        "height": {
          "type": "number",
          "minimum": 0,
          "description": "Height in meters"
        },
        "wheelbase": {
          "type": "number",
          "minimum": 0,
          "description": "Wheelbase in meters",
          "nullable": true
        }
      }
    },

    "WeightCapacity": {
      "type": "object",
      "required": ["empty", "max_gross"],
      "properties": {
        "empty": {
          "type": "integer",
          "minimum": 0,
          "description": "Empty weight in kg"
        },
        "max_gross": {
          "type": "integer", 
          "minimum": 0,
          "description": "Maximum gross weight in kg"
        },
        "max_payload": {
          "type": "integer",
          "minimum": 0,
          "description": "Maximum payload in kg"
        }
      }
    },

    "DriveByWireCapabilities": {
      "type": "object",
      "required": ["steering", "throttle", "brake"],
      "properties": {
        "steering": {
          "$ref": "#/$defs/SteeringSpec"
        },
        "throttle": {
          "$ref": "#/$defs/ThrottleSpec"
        },
        "brake": {
          "$ref": "#/$defs/BrakeSpec"
        },
        "gear": {
          "$ref": "#/$defs/GearSpec"
        },
        "parking_brake": {
          "type": "boolean",
          "default": false
        },
        "turn_signals": {
          "type": "boolean",
          "default": false
        }
      }
    },

    "SteeringSpec": {
      "type": "object",
      "required": ["available", "min_angle", "max_angle"],
      "properties": {
        "available": {
          "type": "boolean"
        },
        "min_angle": {
          "type": "number",
          "description": "Minimum steering angle in degrees"
        },
        "max_angle": {
          "type": "number",
          "description": "Maximum steering angle in degrees"
        },
        "resolution": {
          "type": "number",
          "minimum": 0,
          "description": "Angle resolution in degrees"
        }
      }
    },

    "ThrottleSpec": {
      "type": "object",
      "required": ["available", "min_position", "max_position"],
      "properties": {
        "available": {
          "type": "boolean"
        },
        "min_position": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Minimum throttle position (0-100%)"
        },
        "max_position": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Maximum throttle position (0-100%)"
        },
        "resolution": {
          "type": "number",
          "minimum": 0,
          "description": "Position resolution (%)"
        }
      }
    },

    "BrakeSpec": {
      "type": "object",
      "required": ["available", "min_pressure", "max_pressure"],
      "properties": {
        "available": {
          "type": "boolean"
        },
        "min_pressure": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Minimum brake pressure (0-100%)"
        },
        "max_pressure": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Maximum brake pressure (0-100%)"
        },
        "abs_available": {
          "type": "boolean",
          "default": false,
          "description": "ABS availability"
        },
        "emergency_brake": {
          "type": "boolean",
          "default": false,
          "description": "Emergency brake availability"
        }
      }
    },

    "GearSpec": {
      "type": "object",
      "required": ["available", "gears"],
      "properties": {
        "available": {
          "type": "boolean"
        },
        "gears": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["park", "neutral", "drive", "reverse", "manual1", "manual2", "manual3", "manual4", "manual5"]
          }
        },
        "automatic": {
          "type": "boolean",
          "default": true
        }
      }
    },

    "SensorSpec": {
      "type": "object",
      "required": ["type", "model"],
      "properties": {
        "type": {
          "type": "string",
          "enum": ["lidar", "camera", "radar", "ultrasonic", "imu", "gps", "odometry", "thermal"]
        },
        "model": {
          "type": "string"
        },
        "manufacturer": {
          "type": "string",
          "nullable": true
        },
        "count": {
          "type": "integer",
          "minimum": 1,
          "default": 1
        },
        "position": {
          "$ref": "#/$defs/SensorPosition"
        },
        "field_of_view": {
          "$ref": "#/$defs/FieldOfView"
        },
        "range": {
          "$ref": "#/$defs/SensorRange"
        },
        "resolution": {
          "type": "string",
          "nullable": true
        },
        "frame_rate": {
          "type": "integer",
          "minimum": 1,
          "description": "Frame rate in Hz"
        }
      }
    },

    "SensorPosition": {
      "type": "object",
      "nullable": true,
      "properties": {
        "x": {
          "type": "number",
          "description": "X position in meters from vehicle center"
        },
        "y": {
          "type": "number",
          "description": "Y position in meters from vehicle center"
        },
        "z": {
          "type": "number",
          "description": "Z position in meters from ground"
        },
        "roll": {
          "type": "number",
          "description": "Roll angle in degrees"
        },
        "pitch": {
          "type": "number",
          "description": "Pitch angle in degrees"
        },
        "yaw": {
          "type": "number", 
          "description": "Yaw angle in degrees"
        }
      }
    },

    "FieldOfView": {
      "type": "object",
      "nullable": true,
      "properties": {
        "horizontal": {
          "type": "number",
          "description": "Horizontal field of view in degrees"
        },
        "vertical": {
          "type": "number",
          "description": "Vertical field of view in degrees"
        }
      }
    },

    "SensorRange": {
      "type": "object",
      "nullable": true,
      "properties": {
        "min": {
          "type": "number",
          "minimum": 0,
          "description": "Minimum range in meters"
        },
        "max": {
          "type": "number",
          "minimum": 0,
          "description": "Maximum range in meters"
        }
      }
    },

    "ComputeSpec": {
      "type": "object",
      "required": ["platform", "cpu_cores", "memory_gb", "storage_gb"],
      "properties": {
        "platform": {
          "type": "string",
          "description": "Compute platform (e.g., nvidia_jetson_agx_orin)"
        },
        "cpu_cores": {
          "type": "integer",
          "minimum": 1
        },
        "cpu_arch": {
          "type": "string",
          "enum": ["x86_64", "arm64", "aarch64"]
        },
        "memory_gb": {
          "type": "integer",
          "minimum": 1,
          "description": "RAM in GB"
        },
        "gpu_memory_gb": {
          "type": "integer",
          "minimum": 0,
          "description": "GPU memory in GB"
        },
        "storage_gb": {
          "type": "integer",
          "minimum": 1,
          "description": "Storage in GB"
        },
        "storage_type": {
          "type": "string",
          "enum": ["ssd_nvme", "ssd_sata", "hdd", "emmc"]
        },
        "ai_accelerator": {
          "type": "string",
          "nullable": true,
          "description": "AI acceleration hardware"
        }
      }
    },

    "PowerSpec": {
      "type": "object",
      "required": ["type", "capacity", "voltage"],
      "properties": {
        "type": {
          "type": "string",
          "enum": ["battery", "fuel", "hybrid", "diesel", "gas"]
        },
        "capacity": {
          "type": "string",
          "description": "Energy capacity (e.g., '50kWh', '100L')"
        },
        "voltage": {
          "type": "string",
          "description": "System voltage (e.g., '48V', '400V')"
        },
        "max_power": {
          "type": "string",
          "description": "Maximum power (e.g., '2kW')"
        },
        "charging_types": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["ccs2", "type2", "chademo", "tesla", "j1772", "wireless", "fuel_station"]
          }
        },
        "backup_power": {
          "type": "boolean",
          "default": false,
          "description": "Backup power system available"
        }
      }
    },

    "OperatingConditions": {
      "type": "object",
      "nullable": true,
      "properties": {
        "temperature": {
          "$ref": "#/$defs/TemperatureRange"
        },
        "humidity": {
          "$ref": "#/$defs/HumidityRange"
        },
        "altitude": {
          "$ref": "#/$defs/AltitudeRange"
        },
        "ingress_protection": {
          "type": "string",
          "description": "IP rating (e.g., IP67)"
        },
        "vibration_class": {
          "type": "string",
          "description": "Vibration resistance class"
        },
        "dust_resistance": {
          "type": "boolean",
          "default": false
        },
        "water_resistance": {
          "type": "boolean",
          "default": false
        }
      }
    },

    "TemperatureRange": {
      "type": "object",
      "required": ["min", "max"],
      "properties": {
        "min": {
          "type": "integer",
          "description": "Minimum operating temperature in Celsius"
        },
        "max": {
          "type": "integer",
          "description": "Maximum operating temperature in Celsius"
        }
      }
    },

    "HumidityRange": {
      "type": "object",
      "required": ["min", "max"],
      "properties": {
        "min": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "Minimum relative humidity (%)"
        },
        "max": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "Maximum relative humidity (%)"
        }
      }
    },

    "AltitudeRange": {
      "type": "object",
      "required": ["min", "max"],
      "properties": {
        "min": {
          "type": "integer",
          "description": "Minimum altitude in meters"
        },
        "max": {
          "type": "integer",
          "description": "Maximum altitude in meters"
        }
      }
    },

    "NetworkInterface": {
      "type": "object",
      "required": ["name", "status"],
      "properties": {
        "name": {
          "type": "string"
        },
        "type": {
          "type": "string",
          "enum": ["ethernet", "wifi", "cellular", "satellite"]
        },
        "status": {
          "type": "string", 
          "enum": ["up", "down", "unknown"]
        },
        "ip_address": {
          "type": "string",
          "nullable": true
        },
        "mac_address": {
          "type": "string",
          "nullable": true
        },
        "speed_mbps": {
          "type": "integer",
          "nullable": true
        },
        "signal_strength": {
          "type": "integer",
          "nullable": true,
          "description": "Signal strength in dBm or percentage"
        }
      }
    }
  }
}
